#include <stdio.h>
#include <string.h>

int count = 10; // Nombre actuel de contacts
int trouver =1;
int boucle_while =0;
char nom_et_prenom_pour_modifier[50];

struct Equipe{
int id;
char nom_et_prenom[50];
int numeroMaillot;
char poste[11];
int age;
int buts;
int statu;
};
struct Equipe equip[100] = {
    {0,"ayoub Benzema", 9,"attaquant",35,210,0},
    {1,"karim Benzema", 9,"attaquant",35,210,0},
    {2,"kianluigi Donnarumma", 99, "gardien", 25, 0,1},
    {3,"airgil van Dijk", 4, "défenseur", 33, 15,0},
    {4,"luka Modric", 10, "milieu", 39, 45,0},
    {5,"kylian Mbappé", 7, "attaquant", 26, 220,1},
    {6,"manuel Neuer", 1, "gardien", 38, 0,0},
    {7,"sergio Ramos", 4, "défenseur", 39, 105,0},
    {8,"sevin De Bruyne", 17, "milieu", 34, 95,0},
    {9,"robert Lewandowski", 9, "attaquant", 37, 320,0},
    {10,"achraf Hakimi", 2, "défenseur",27,25,0}
};
int choix_de_post;

void clear_buffer() {
    int c;
    while ((c = getchar()) != '\n' && c != EOF);
}



void line(){

  printf("\n --------------------------------------\n");
}



//---------------------------------------------------------------------------------

void Ajouter_un_joueur(int choix_count_joeur){
    
for(int count_joeur =0;count_joeur<choix_count_joeur;count_joeur++){
boucle_while =0;
clear_buffer();
 printf("\nEnter nom et prenom de jouer %d: ",count_joeur+1);
  
  fgets(equip[count].nom_et_prenom, sizeof(equip[count].nom_et_prenom), stdin);
  equip[count].nom_et_prenom[strcspn(equip[count].nom_et_prenom, "\n")] = '\0';

int char_n =0;

 while (equip[count].nom_et_prenom[char_n] != '\0')
 {
  if (equip[count].nom_et_prenom[char_n]>='A'&&equip[count].nom_et_prenom[char_n]<='Z')
  {
    equip[count].nom_et_prenom[char_n] =equip[count].nom_et_prenom[char_n] + 32;
  }

  char_n++;
 }
 
  printf("Enter numero Maillot de joeur %d: ",count_joeur+1);
  scanf("%d",&equip[count].numeroMaillot);
while (boucle_while != 1)
{
  printf("choisir le poste :\n1)gardien\n2)défenseur\n3)milieu\n4)attaquant");
  printf("\n Enter num de poste de joeur %d :",count_joeur+1);
  scanf("%d",&choix_de_post);
  if(choix_de_post==1||choix_de_post==2||choix_de_post==3||choix_de_post==4){
    boucle_while =1;
  switch(choix_de_post){
       case 1:
       strcpy(equip[count].poste,"gardien");
       break;
       case 2:
       strcpy(equip[count].poste,"défenseur");
       break;
       case 3:
       strcpy(equip[count].poste,"milieu");
       break;
       case 4:
       strcpy(equip[count].poste,"attaquant");
       break;

       
  }

}else{
    printf("\n !! choix incorect !!\n");
}
}

printf("Enter age  de joeur %d : ",count_joeur+1);
scanf("%d",&equip[count].age);

printf("Enter buts de joeur %d : ",count_joeur+1);
scanf("%d",&equip[count].buts);
equip[count].statu=0;
line();
count ++;
equip[count].id+=1;
    }
}

//---------------------------------------------------------------------------------
void Afficher_un_joueur(int choix_Affichage){
    switch(choix_Affichage){
case 1: // Tri alphabétique par nom (seulement le premier nom)
    for (int step = 0; step < count - 1; step++) {
        int min_idx = step;
        for (int i = step + 1; i < count; i++) {
          

         
           
            if (strcmp(equip[i].nom_et_prenom, equip[min_idx].nom_et_prenom) > 0) {
                min_idx = i;
            }
        }

       
        if (min_idx != step) {
            struct Equipe temp = equip[step];
            equip[step] = equip[min_idx];
            equip[min_idx] = temp;
        }

             if(equip[min_idx].statu != 1){
                       printf("\nJoueur |id : %d|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        equip[step].id, equip[step].nom_et_prenom, equip[step].numeroMaillot, equip[step].poste, equip[step].age, equip[step].buts);
                       }
                       }
         break;


case 2: // Tri par âg

        
            for (int step = 0; step < count; step++) {
                int min_idx = step;
                for (int i = step + 1; i < count; i++) {
                    if (equip[i].age < equip[min_idx].age){
                        min_idx = i;
                    }
                }
                if(min_idx != step){
                    struct Equipe temp = equip[step];
                    equip[step] = equip[min_idx];
                    equip[min_idx] = temp;
                }
                       printf("\nJoueur %d :\nNom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        step + 1, equip[step].nom_et_prenom, equip[step].numeroMaillot, equip[step].poste, equip[step].age, equip[step].buts);
             }
            break;

  case 3:


  boucle_while=0;
  while (boucle_while != 1)
{
  printf("Afficher les joueurs par :\n1)gardien\n2)défenseur\n3)milieu\n4)attaquant");
  printf("\n Enter num de poste :");
  scanf("%d",&choix_de_post);
  if(choix_de_post==1||choix_de_post==2||choix_de_post==3||choix_de_post==4){
 
    boucle_while =1;
  switch(choix_de_post){
   
       case 1:
      
       for (int i = 0; i < count; i++) {
           
       if(strcmp(equip[i].poste,"gardien")==0){
      
          printf("\nJoueur %d :|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        i + 1, equip[i].nom_et_prenom, equip[i].numeroMaillot, equip[i].poste, equip[i].age, equip[i].buts);
     

       }

       }
      
       break;
       case 2:
              for (int i = 0; i < count; i++) {
            
       if(strcmp(equip[i].poste,"défenseur")==0){
          printf("\nJoueur %d :|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        i + 1, equip[i].nom_et_prenom, equip[i].numeroMaillot, equip[i].poste, equip[i].age, equip[i].buts);
     

       }

       }

       break;
       case 3:
       for (int i = 0; i < count; i++) {
            
       if(strcmp(equip[i].poste,"milieu")==0){
          printf("\nJoueur %d :|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        i + 1, equip[i].nom_et_prenom, equip[i].numeroMaillot, equip[i].poste, equip[i].age, equip[i].buts);
     

       }

       }
       break;
       case 4:
        for (int i = 0; i < count; i++) {
            
       if(strcmp(equip[i].poste,"attaquant")==0){
          printf("\nJoueur %d :|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                        i + 1, equip[i].nom_et_prenom, equip[i].numeroMaillot, equip[i].poste, equip[i].age, equip[i].buts);
     

       }

       }
       break;

      }
    }else{

  printf("\n !! choix incorect !!\n");
      }
    }

 }

}
void modifier_un_joueur(){
    int choix_modifier;
     boucle_while=0;
     int check;
  while (boucle_while != 1)
{  
    
     printf("\nEnter nom et prenom de jouer pour modifier : ");
  
  fgets(nom_et_prenom_pour_modifier, sizeof(nom_et_prenom_pour_modifier), stdin);
  nom_et_prenom_pour_modifier[strcspn(nom_et_prenom_pour_modifier, "\n")] = '\0';
  
    for(check =0;check < count;check++){
        if(strcmp(equip[check].nom_et_prenom,nom_et_prenom_pour_modifier)==0){
            trouver =0;
    printf("modifier le :\n1)Modifier le poste :\n2)Modifier âge: \n3)Modifier le nombre de buts :");
     printf("\n choiser :");
     scanf("%d",&choix_modifier);

        if(choix_modifier==1||choix_modifier==2||choix_modifier==3){
            
    switch(choix_modifier){

    case 1:
   
   clear_buffer();
   
            
           
    
     printf("choisir le neuvaux poste :\n1)gardien: \n2)défenseur: \n3)milieu: \n4)attaquant: ");
     scanf("%d",&choix_modifier);
     if(choix_modifier==1||choix_modifier==2||choix_modifier==3||choix_modifier==4){
         switch(choix_de_post){
       case 1:
       strcpy(equip[check].poste,"gardien");
       break;
       case 2:
       strcpy(equip[check].poste,"défenseur");
       break;
       case 3:
       strcpy(equip[check].poste,"milieu");
       break;
       case 4:
       strcpy(equip[check].poste,"attaquant");
       break;

         }
      }
      
      
  
    break;

   case 2:
printf("choisir le neuvaux age pour %s : ",equip[check].nom_et_prenom);
scanf("%d",&equip[check].age);
    break;
printf("choisir le neuvaux nombre de buts pour %s : ",equip[check].nom_et_prenom);
scanf("%d",&equip[check].buts);
   case 3:
     printf("Entre Le Id de joeur : ");
     scanf("%d",&equip[check].age);

   break;
   
   
    }
    boucle_while=1;
   
    } 
    }
    else if(check +1 == count && trouver == 1){
        printf("!! no trouver !!");}
}

    }
}
void Rechercher_un_joueur(){
int choix_Rechercher;
int id_Rechercher;
char nom_Rechercher[20];
 printf("\n choix de recherch:\n1)par id : \n2) par nom :");
 printf("\n choisir :");
     scanf("%d",&choix_Rechercher);
     if(choix_Rechercher==1||choix_Rechercher==2){
  switch(choix_Rechercher){
    
         
    case 1:
     printf("\n Entre id :");
     scanf("%d",&id_Rechercher);
     if(id_Rechercher<= count&&equip[count].statu){

         printf("\nJoueur :id : %d|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                       id_Rechercher, equip[id_Rechercher].nom_et_prenom, equip[id_Rechercher].numeroMaillot, equip[id_Rechercher].poste, equip[id_Rechercher].age, equip[id_Rechercher].buts);
     
     }else{
printf("!! no result !!");
     }

    break;

    case 2:
    clear_buffer();
printf("\nEnter nom  pour Rechercher : ");
  
  fgets(nom_Rechercher, sizeof(nom_Rechercher), stdin);
  nom_Rechercher[strcspn(nom_Rechercher, "\n")] = '\0';
  
    
     
     for(int getnom =0;getnom < count;getnom++){
        char prenom1[50];
        int k = 0;
        int trouv=1;
            while (equip[getnom].nom_et_prenom[k] != ' ' && equip[getnom].nom_et_prenom[k] != '\0') {
                prenom1[k] = equip[getnom].nom_et_prenom[k];
                k++;
            }
            prenom1[k] = '\0';
if(strcmp(prenom1,nom_Rechercher)==0){
trouv=0;
  printf("\nJoueur :id : %d|Nom et prénom : %s|Maillot : %d |Poste : %s|Age : %d|Buts : %d\n", 
                       getnom, equip[getnom].nom_et_prenom, equip[getnom].numeroMaillot, equip[getnom].poste, equip[getnom].age, equip[getnom].buts);
   

}else if(getnom +1 ==count &&trouv==1){

printf("!! no result !!");

}
        }
    
    break;
    }
     }
     
    }

    void Supprimer_un_joueur(){
        int id_pour_Supprimer;
       printf("\n Entre id pour Supprimer :");
       scanf("%d",&id_pour_Supprimer);
     if(id_pour_Supprimer<= count){
        for(int r =0;r< count ;r++){
            if(equip[r].id==id_pour_Supprimer){

           equip[r].statu=1;

            }
        }
     }
    } 
void menu(){
 		int choix;
 		while(1){
 			line();
 		printf("\n click enter to chow menu ");
 		
 		if(getchar()=='\n'){
 		printf("\n 1. Ajouter un Contact");
 		printf("\n 2. Modifier un Contact");
 		printf("\n 3 . Supprimer un Contact");
 		printf("\n 4. Afficher Tous les Contacts");
 		printf("\n 5. Rechercher un Contact");
 		
 		printf("\n Entre choix : ");
 		scanf("%d",&choix);
 		clear_buffer();
 		switch(choix){
 			case 1:
           
 			Ajouter_un_joueur(1);
 			break;
 			case 2:
 			modifier_un_joueur();
 			break;
 			case 3:
 			Supprimer_un_joueur();
 			break;
 			
 			case 4:
 			 Afficher_un_joueur(1);
 			break;
 			case 5:
 			Rechercher_un_joueur();
 			break;
 			
 			
 			
 			}
 		}else{break;}
 		}
 		
 		}
    
void  main() {
   struct Equipe e;
   menu();

  }
